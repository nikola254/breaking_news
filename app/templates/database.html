{% extends "base.html" %}

{% block title %}NewsAnalytics - –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö{% endblock %}

{% block head %}
{{ super() }}
<link rel="stylesheet" href="{{ url_for('static', filename='css/database.css') }}">
{% endblock %}

{% block content %}
<div class="database-container">
    <h1>–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö ClickHouse</h1>
    <div id="error-container"></div>
    
    <!-- –ë–ª–æ–∫ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ -->
    <div class="statistics-container">
        <h2 class="statistics-title">üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö</h2>
        <div id="statistics-content" class="loading-stats">
            –ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏...
        </div>
    </div>
    
    <div class="search-container">
        <input type="text" id="search-input" class="search-input" placeholder="–ü–æ–∏—Å–∫ –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º...">
        <button id="search-btn" class="search-btn">–ü–æ–∏—Å–∫</button>
    </div>

    <div class="db-controls">
        <div class="db-selector">
            <button class="db-btn active" data-source="all">–í—Å–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏</button>
            
            <div class="source-divider"></div>
            
            <!-- –†–æ—Å—Å–∏–π—Å–∫–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ -->
            <button class="db-btn" data-source="ria">–†–ò–ê –ù–æ–≤–æ—Å—Ç–∏</button>
            <button class="db-btn" data-source="lenta">–õ–µ–Ω—Ç–∞.—Ä—É</button>
            <button class="db-btn" data-source="rbc">–†–ë–ö</button>
            <button class="db-btn" data-source="gazeta">–ì–∞–∑–µ—Ç–∞.—Ä—É</button>
            <button class="db-btn" data-source="kommersant">–ö–æ–º–º–µ—Ä—Å–∞–Ω—Ç—ä</button>
            <button class="db-btn" data-source="rt">RT</button>
            
            <div class="source-divider"></div>
            
            <!-- –£–∫—Ä–∞–∏–Ω—Å–∫–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ -->
            <button class="db-btn" data-source="tsn">–¢–°–ù</button>
            <button class="db-btn" data-source="unian">–£–ù–ò–ê–ù</button>
            
            <div class="source-divider"></div>
            
            <!-- –ú–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ -->
            <button class="db-btn" data-source="cnn">CNN</button>
            <button class="db-btn" data-source="bbc">BBC</button>
            <button class="db-btn" data-source="reuters">Reuters</button>
            <button class="db-btn" data-source="aljazeera">Al Jazeera</button>
            <button class="db-btn" data-source="euronews">Euronews</button>
            <button class="db-btn" data-source="france24">France 24</button>
            <button class="db-btn" data-source="dw">Deutsche Welle</button>
            <button class="db-btn" data-source="israil">7kanal.co.il</button>
            
            <div class="source-divider"></div>
            
            <!-- –°–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏ -->
            <button class="db-btn" data-source="telegram">Telegram</button>
            <button class="db-btn" data-source="twitter">Twitter</button>
            <button class="db-btn" data-source="vk">–í–ö–æ–Ω—Ç–∞–∫—Ç–µ</button>
            <button class="db-btn" data-source="ok">–û–¥–Ω–æ–∫–ª–∞—Å—Å–Ω–∏–∫–∏</button>
        </div>
        
        <div class="filter-controls">
            <div id="filter-container">
                <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã -->
            </div>
            
            <label for="days-select">–ü–µ—Ä–∏–æ–¥:</label>
            <select id="days-select" class="days-select">
                <option value="1">1 –¥–µ–Ω—å</option>
                <option value="3">3 –¥–Ω—è</option>
                <option value="7" selected>7 –¥–Ω–µ–π</option>
                <option value="14">14 –¥–Ω–µ–π</option>
                <option value="30">30 –¥–Ω–µ–π</option>
            </select>
        </div>
    </div>
    
    <div id="loading" class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...</div>
    
    <table class="news-table" id="data-table">
        <thead>
            <tr id="table-header">
                <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã -->
            </tr>
        </thead>
        <tbody id="table-body"></tbody>
    </table>
    
    <div class="pagination" id="pagination"></div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Å—Ç–∞—Ç—å–∏ -->
<!-- .article-modal-overlay - –ø–æ–ª—É–ø—Ä–æ–∑—Ä–∞—á–Ω—ã–π —Ñ–æ–Ω –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ -->
<div id="article-modal" class="article-modal-overlay">
    <!-- .article-modal-window - –æ—Å–Ω–æ–≤–Ω–æ–µ –æ–∫–Ω–æ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –¥–∏–∞–ª–æ–≥–∞ -->
    <div class="article-modal-window">
        <!-- .article-modal-top - –≤–µ—Ä—Ö–Ω—è—è —á–∞—Å—Ç—å —Å –∑–∞–≥–æ–ª–æ–≤–∫–æ–º –∏ –∫–Ω–æ–ø–∫–æ–π –∑–∞–∫—Ä—ã—Ç–∏—è -->
        <div class="article-modal-top">
            <!-- .article-title - –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç–∞—Ç—å–∏ -->
            <h2 class="article-title" id="modal-title">–ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç–∞—Ç—å–∏</h2>
            <!-- .article-close-btn - –∫–Ω–æ–ø–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ -->
            <button class="article-close-btn">&times;</button>
        </div>
        <!-- .article-modal-main - –æ—Å–Ω–æ–≤–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Å—Ç–∞—Ç—å–∏ -->
        <div class="article-modal-main" id="modal-content">
            –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ —Å—Ç–∞—Ç—å–∏...
        </div>
        <!-- .article-modal-bottom - –Ω–∏–∂–Ω—è—è —á–∞—Å—Ç—å —Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏ –∏ —Å—Å—ã–ª–∫–æ–π -->
        <div class="article-modal-bottom">
            <!-- .article-info - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –∏—Å—Ç–æ—á–Ω–∏–∫–µ –∏ –¥–∞—Ç–µ -->
            <div class="article-info">
                <span id="modal-source">–ò—Å—Ç–æ—á–Ω–∏–∫</span> | 
                <span id="modal-date">–î–∞—Ç–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏</span>
            </div>
            <!-- .article-original-link - —Å—Å—ã–ª–∫–∞ –Ω–∞ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—É—é —Å—Ç–∞—Ç—å—é -->
            <a href="#" target="_blank" id="modal-link" class="article-original-link">–û—Ç–∫—Ä—ã—Ç—å –æ—Ä–∏–≥–∏–Ω–∞–ª</a>
        </div>
    </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –≤—ã–±–æ—Ä–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –ø–∞—Ä—Å–∏–Ω–≥–∞ -->
<div id="parser-modal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h2 class="modal-title">–í—ã–±–µ—Ä–∏—Ç–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞</h2>
            <button class="close-modal">&times;</button>
        </div>
        <div class="modal-body">
            <div class="parser-options">
                <div class="parser-group">
                    <h4>–†–æ—Å—Å–∏–π—Å–∫–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏</h4>
                    <label><input type="checkbox" name="parser" value="ria" checked><span>–†–ò–ê –ù–æ–≤–æ—Å—Ç–∏</span></label>
                    <label><input type="checkbox" name="parser" value="lenta" checked><span>Lenta.ru</span></label>
                    <label><input type="checkbox" name="parser" value="rbc" checked><span>RBC</span></label>
                    <label><input type="checkbox" name="parser" value="gazeta" checked><span>Gazeta.ru</span></label>
                    <label><input type="checkbox" name="parser" value="kommersant" checked><span>Kommersant</span></label>
                </div>
                <div class="parser-group">
                    <h4>–£–∫—Ä–∞–∏–Ω—Å–∫–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏</h4>
                    <label><input type="checkbox" name="parser" value="tsn" checked><span>TSN.ua</span></label>
                    <label><input type="checkbox" name="parser" value="unian" checked><span>UNIAN.ua</span></label>
                </div>
                <div class="parser-group">
                    <h4>–ú–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏</h4>
                    <label><input type="checkbox" name="parser" value="rt" checked><span>RT.com</span></label>
                    <label><input type="checkbox" name="parser" value="cnn" checked><span>CNN</span></label>
                    <label><input type="checkbox" name="parser" value="aljazeera" checked><span>Al Jazeera</span></label>
                    <label><input type="checkbox" name="parser" value="reuters" checked><span>Reuters</span></label>
                    <label><input type="checkbox" name="parser" value="france24" checked><span>France 24</span></label>
                    <label><input type="checkbox" name="parser" value="dw" checked><span>Deutsche Welle</span></label>
                    <label><input type="checkbox" name="parser" value="euronews" checked><span>Euronews</span></label>
                </div>
                <div class="parser-group social-media-group">
                    <h4>–°–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏</h4>
                    <div class="social-platform">
                        <label><input type="checkbox" name="parser" value="twitter" id="twitter-parser"><span>Twitter</span></label>
                        <div class="social-config" id="twitter-config" style="display: none;">
                            <input type="text" placeholder="–ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)" id="twitter-keywords">
                            <input type="text" placeholder="–•—ç—à—Ç–µ–≥–∏ (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)" id="twitter-hashtags">
                            <input type="number" placeholder="–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Å—Ç–æ–≤" value="100" id="twitter-count">
                        </div>
                    </div>
                    <div class="social-platform">
                        <label><input type="checkbox" name="parser" value="vk" id="vk-parser"><span>–í–ö–æ–Ω—Ç–∞–∫—Ç–µ</span></label>
                        <div class="social-config" id="vk-config" style="display: none;">
                            <input type="text" placeholder="ID –≥—Ä—É–ø–ø (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)" id="vk-groups">
                            <input type="text" placeholder="–ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)" id="vk-keywords">
                            <input type="number" placeholder="–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Å—Ç–æ–≤" value="100" id="vk-count">
                        </div>
                    </div>
                    <div class="social-platform">
                        <label><input type="checkbox" name="parser" value="ok" id="ok-parser"><span>–û–¥–Ω–æ–∫–ª–∞—Å—Å–Ω–∏–∫–∏</span></label>
                        <div class="social-config" id="ok-config" style="display: none;">
                            <input type="text" placeholder="ID –≥—Ä—É–ø–ø (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)" id="ok-groups">
                            <input type="text" placeholder="–ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)" id="ok-keywords">
                            <input type="number" placeholder="–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Å—Ç–æ–≤" value="100" id="ok-count">
                        </div>
                    </div>
                </div>
                <div class="parser-group">
                    <h4>–î—Ä—É–≥–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏</h4>
                    <label><input type="checkbox" name="parser" value="israil" checked><span>7kanal.co.il</span></label>
                    <label><input type="checkbox" name="parser" value="telegram" checked><span>Telegram –∫–∞–Ω–∞–ª—ã</span></label>
                </div>
                <div class="parser-group">
                    <h4>–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –ø–∞—Ä—Å–µ—Ä</h4>
                    <label><input type="checkbox" name="parser" value="universal" id="universal-parser-checkbox"><span>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π —Å–∞–π—Ç</span></label>
                    <div class="custom-site-input" id="custom-site-container" style="display: none; margin-top: 10px;">
                        <label for="custom-site-url">URL —Å–∞–π—Ç–∞ –∏–ª–∏ –¥–æ–º–µ–Ω:</label>
                        <input type="text" id="custom-site-url" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: https://example.com –∏–ª–∏ example.com" style="width: 100%; margin-top: 5px; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
                        <small style="color: #666; display: block; margin-top: 5px;">–í–≤–µ–¥–∏—Ç–µ –ø–æ–ª–Ω—ã–π URL –∏–ª–∏ –¥–æ–º–µ–Ω —Å–∞–π—Ç–∞ –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞</small>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal-footer">
            <button id="start-parsing-btn" class="btn btn-primary">–ó–∞–ø—É—Å—Ç–∏—Ç—å –ø–∞—Ä—Å–∏–Ω–≥</button>
        </div>
    </div>
</div>

<!-- –û–∫–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –ø–∞—Ä—Å–µ—Ä–∞ -->
<div id="parser-log">
    <div class="log-header">
        <span>–õ–æ–≥ –ø–∞—Ä—Å–∏–Ω–≥–∞</span>
        <div class="log-controls">
            <button id="stop-parsing-btn" class="stop-btn" title="–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–∞—Ä—Å–∏–Ω–≥">‚èπ</button>
            <button class="log-close">&times;</button>
        </div>
    </div>
    <div class="log-content" id="log-content">
        <!-- –õ–æ–≥–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/database.js') }}"></script>
{% endblock %}