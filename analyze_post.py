#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
–ê–Ω–∞–ª–∏–∑ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ—Å—Ç–∞ –Ω–∞ —ç–∫—Å—Ç—Ä–µ–º–∏—Å—Ç—Å–∫–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç
"""

import sys
import os
sys.path.append(os.path.join(os.path.dirname(__file__), 'app'))

from app.ai.content_classifier import ExtremistContentClassifier

def analyze_post():
    # –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º—ã–π —Ç–µ–∫—Å—Ç
    text = '–°–ª—É–∂–±–∞ –≤–Ω–µ—à–Ω–µ–π —Ä–∞–∑–≤–µ–¥–∫–∏ –†–æ—Å—Å–∏–∏ –≤—ã–ø—É—Å—Ç–∏–ª–∞ —Å–±–æ—Ä–Ω–∏–∫ —Ä–∞—Å—Å–µ–∫—Ä–µ—á–µ–Ω–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –≤—Ä–µ–º—ë–Ω –í–µ–ª–∏–∫–æ–π –û—Ç–µ—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–π –≤–æ–π–Ω—ã. #–†–æ—Å—Å–∏—è @new_militarycolumnist'
    
    print('üîç –ê–Ω–∞–ª–∏–∑ –ø–æ—Å—Ç–∞ –æ –°–í–† –†–æ—Å—Å–∏–∏')
    print('=' * 80)
    print(f'–¢–µ–∫—Å—Ç: {text}')
    print()
    
    classifier = ExtremistContentClassifier()
    
    # –°—Ç–∞—Ä–∞—è —Å–∏—Å—Ç–µ–º–∞
    print('–°–¢–ê–†–ê–Ø –°–ò–°–¢–ï–ú–ê:')
    old_result = classifier.analyze_extremism_percentage(text)
    print(f'  ‚Ä¢ –ü—Ä–æ—Ü–µ–Ω—Ç —ç–∫—Å—Ç—Ä–µ–º–∏–∑–º–∞: {old_result.get("extremism_percentage", 0)}%')
    print(f'  ‚Ä¢ –£—Ä–æ–≤–µ–Ω—å —Ä–∏—Å–∫–∞: {old_result.get("risk_level", "none")}')
    print(f'  ‚Ä¢ –ú–µ—Ç–æ–¥: {old_result.get("method", "unknown")}')
    print()
    
    # –ù–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –§–ó-114
    print('–ù–û–í–ê–Ø –°–ò–°–¢–ï–ú–ê –§–ó-114:')
    new_result = classifier.analyze_extremism_fz114(text)
    print(f'  ‚Ä¢ –ü—Ä–æ—Ü–µ–Ω—Ç —ç–∫—Å—Ç—Ä–µ–º–∏–∑–º–∞: {new_result["extremism_percentage"]}%')
    print(f'  ‚Ä¢ –£—Ä–æ–≤–µ–Ω—å —Ä–∏—Å–∫–∞: {new_result["risk_level"]}')
    print(f'  ‚Ä¢ –≠–∫—Å—Ç—Ä–µ–º–∏—Å—Ç—Å–∫–∏–π: {new_result["is_extremist"]}')
    
    if new_result['fz114_violations']:
        print(f'  ‚Ä¢ –ù–∞—Ä—É—à–µ–Ω–∏—è –§–ó-114: {", ".join(new_result["fz114_violations"])}')
    
    if new_result['detected_categories']:
        print(f'  ‚Ä¢ –û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏:')
        for category, details in new_result['detected_categories'].items():
            print(f'    - {category}: {details["keywords"]} (—Å–µ—Ä—å–µ–∑–Ω–æ—Å—Ç—å: {details["severity"]})')
    
    if new_result['threat_patterns_found']:
        print(f'  ‚Ä¢ –ü–∞—Ç—Ç–µ—Ä–Ω—ã —É–≥—Ä–æ–∑: {len(new_result["threat_patterns_found"])}')
    
    if new_result['hate_speech_patterns_found']:
        print(f'  ‚Ä¢ –ü–∞—Ç—Ç–µ—Ä–Ω—ã —è–∑—ã–∫–∞ –≤—Ä–∞–∂–¥—ã: {len(new_result["hate_speech_patterns_found"])}')
    
    print(f'  ‚Ä¢ –û–±—ä—è—Å–Ω–µ–Ω–∏–µ: {new_result["explanation"]}')
    print()
    
    print('üìä –ê–ù–ê–õ–ò–ó –†–ï–ó–£–õ–¨–¢–ê–¢–û–í:')
    print('-' * 40)
    
    old_percentage = old_result.get('extremism_percentage', 0)
    new_percentage = new_result['extremism_percentage']
    
    if new_percentage == 0:
        print('‚úÖ –ü–æ—Å—Ç –ù–ï —Å–æ–¥–µ—Ä–∂–∏—Ç —ç–∫—Å—Ç—Ä–µ–º–∏—Å—Ç—Å–∫–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ —Å–æ–≥–ª–∞—Å–Ω–æ –§–ó-114')
    else:
        print('‚ö†Ô∏è –û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –ø—Ä–∏–∑–Ω–∞–∫–∏ —ç–∫—Å—Ç—Ä–µ–º–∏—Å—Ç—Å–∫–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞')
    
    if old_percentage > 50:
        print('‚ùå –°—Ç–∞—Ä–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–∞–ª–∞ –ª–æ–∂–Ω–æ–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç')
        print('üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É –§–ó-114 –¥–ª—è –±–æ–ª–µ–µ —Ç–æ—á–Ω–æ–π –æ—Ü–µ–Ω–∫–∏')
    
    print(f'\nüîÑ –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º:')
    print(f'  –°—Ç–∞—Ä–∞—è —Å–∏—Å—Ç–µ–º–∞: {old_percentage}% —ç–∫—Å—Ç—Ä–µ–º–∏–∑–º–∞')
    print(f'  –ù–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –§–ó-114: {new_percentage}% —ç–∫—Å—Ç—Ä–µ–º–∏–∑–º–∞')
    print(f'  –†–∞–∑–Ω–∏—Ü–∞: {abs(old_percentage - new_percentage)}%')
    
    # –û–±—ä—è—Å–Ω–µ–Ω–∏–µ –ø–æ—á–µ–º—É —Å—Ç–∞—Ä–∞—è —Å–∏—Å—Ç–µ–º–∞ –º–æ–≥–ª–∞ –¥–∞—Ç—å –≤—ã—Å–æ–∫–∏–π –ø—Ä–æ—Ü–µ–Ω—Ç
    print(f'\nü§î –í–û–ó–ú–û–ñ–ù–´–ï –ü–†–ò–ß–ò–ù–´ –í–´–°–û–ö–û–ô –û–¶–ï–ù–ö–ò –°–¢–ê–†–û–ô –°–ò–°–¢–ï–ú–´:')
    print('1. –û–±–ª–∞—á–Ω–∞—è –º–æ–¥–µ–ª—å –º–æ–∂–µ—Ç —Ä–µ–∞–≥–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ —Å–ª–æ–≤–∞ "—Ä–∞–∑–≤–µ–¥–∫–∞", "–†–æ—Å—Å–∏—è"')
    print('2. –ö–æ–Ω—Ç–µ–∫—Å—Ç –≤–æ–µ–Ω–Ω–æ–π —Ç–µ–º–∞—Ç–∏–∫–∏ (–í–µ–ª–∏–∫–∞—è –û—Ç–µ—á–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –≤–æ–π–Ω–∞)')
    print('3. –£–ø–æ–º–∏–Ω–∞–Ω–∏–µ –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä')
    print('4. –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –º–æ–¥–µ–ª–∏ –Ω–∞ —Ä–∞–∑–ª–∏—á–µ–Ω–∏–µ –Ω–æ–≤–æ—Å—Ç–Ω–æ–≥–æ –∏ —ç–∫—Å—Ç—Ä–µ–º–∏—Å—Ç—Å–∫–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞')
    
    print(f'\n‚úÖ –ü–†–ï–ò–ú–£–©–ï–°–¢–í–ê –ù–û–í–û–ô –°–ò–°–¢–ï–ú–´ –§–ó-114:')
    print('1. –¢–æ—á–Ω–æ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ä–æ—Å—Å–∏–π—Å–∫–æ–º—É –∑–∞–∫–æ–Ω–æ–¥–∞—Ç–µ–ª—å—Å—Ç–≤—É')
    print('2. –ê–Ω–∞–ª–∏–∑ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ —ç–∫—Å—Ç—Ä–µ–º–∏–∑–º–∞, –∞ –Ω–µ –æ–±—â–∏—Ö —Å–ª–æ–≤')
    print('3. –†–∞–∑–ª–∏—á–µ–Ω–∏–µ –Ω–æ–≤–æ—Å—Ç–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –æ—Ç —ç–∫—Å—Ç—Ä–µ–º–∏—Å—Ç—Å–∫–æ–≥–æ')
    print('4. –î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ —Å —É–∫–∞–∑–∞–Ω–∏–µ–º —Å—Ç–∞—Ç–µ–π –∑–∞–∫–æ–Ω–∞')

if __name__ == "__main__":
    analyze_post()