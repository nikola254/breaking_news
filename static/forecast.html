<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NewsAnalytics - –ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #0a1f3d;
            color: #e0e0e0;
        }
        .header {
            background-color: #0d2b50;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
        }
        .logo {
            font-size: 24px;
            font-weight: bold;
            color: #4fc3f7;
            display: flex;
            align-items: center;
        }
        .logo-icon {
            margin-right: 10px;
            font-size: 28px;
        }
        .main-nav {
            display: flex;
        }
        .main-nav a {
            color: #bbdefb;
            text-decoration: none;
            padding: 10px 15px;
            margin: 0 5px;
            border-radius: 4px;
            transition: all 0.3s;
        }
        .main-nav a:hover {
            background-color: #1e3a6a;
            color: #ffffff;
        }
        .main-nav a.active {
            background-color: #1976d2;
            color: white;
        }
        .user-actions {
            display: flex;
            align-items: center;
        }
        .user-actions button {
            background-color: #1976d2;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 4px;
            cursor: pointer;
            margin-left: 10px;
            transition: all 0.3s;
        }
        .user-actions button:hover {
            background-color: #1565c0;
        }
        .content {
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }
        .forecast-container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-top: 20px;
        }
        .forecast-card {
            background-color: #0d2b50;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
            flex: 1;
            min-width: 300px;
        }
        .forecast-card h2 {
            color: #4fc3f7;
            margin-top: 0;
            border-bottom: 1px solid #1e3a6a;
            padding-bottom: 10px;
        }
        .forecast-controls {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        .forecast-select {
            background-color: #0d2b50;
            color: #e0e0e0;
            border: 1px solid #1976d2;
            padding: 8px;
            border-radius: 4px;
            min-width: 150px;
        }
        .forecast-btn {
            background-color: #1976d2;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s;
        }
        .forecast-btn:hover {
            background-color: #1565c0;
        }
        .forecast-result {
            margin-top: 20px;
        }
        .forecast-chart {
            width: 100%;
            height: 300px;
            background-color: #1e3a6a;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-top: 15px;
        }
        .forecast-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        .forecast-table th, .forecast-table td {
            padding: 10px;
            text-align: left;
            border-bottom: 1px solid #1e3a6a;
        }
        .forecast-table th {
            background-color: #1e3a6a;
            color: #4fc3f7;
        }
        .loading {
            text-align: center;
            padding: 20px;
            font-size: 18px;
            color: #4fc3f7;
        }
        .error-message {
            background-color: #c62828;
            color: white;
            padding: 10px;
            border-radius: 4px;
            margin-bottom: 15px;
        }
        .footer {
            background-color: #0d2b50;
            padding: 15px 20px;
            text-align: center;
            margin-top: 30px;
            color: #bbdefb;
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="logo">
            <span class="logo-icon">üìä</span> NewsAnalytics Pro
        </div>
        <div class="main-nav">
            <a href="/">–ì–ª–∞–≤–Ω–∞—è</a>
            <a href="/analytics">–ê–Ω–∞–ª–∏—Ç–∏–∫–∞</a>
            <a href="/clickhouse">–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö</a>
            <a href="/reports">–û—Ç—á–µ—Ç—ã</a>
            <a href="/trends">–¢—Ä–µ–Ω–¥—ã</a>
            <a href="/forecast" class="active">–ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ</a>
            <a href="/archive">–ê—Ä—Ö–∏–≤</a>
            <a href="/about">–û –ø—Ä–æ–µ–∫—Ç–µ</a>
        </div>
        <div class="user-actions">
            <button id="refresh-btn">–û–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ</button>
        </div>
    </div>
    
    <div class="content">
        <h1>–ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–æ–≤–æ—Å—Ç–Ω—ã—Ö —Ç–µ–Ω–¥–µ–Ω—Ü–∏–π</h1>
        <div id="error-container"></div>
        
        <div class="forecast-controls">
            <div>
                <label for="model-select">–ú–æ–¥–µ–ª—å –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è:</label>
                <select id="model-select" class="forecast-select">
                    <option value="lstm" selected>LSTM (–î–æ–ª–≥–∞—è –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–∞—è –ø–∞–º—è—Ç—å)</option>
                    <option value="arima">ARIMA (–ê–≤—Ç–æ—Ä–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω–æ–µ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–∫–æ–ª—å–∑—è—â–µ–µ —Å—Ä–µ–¥–Ω–µ–µ)</option>
                </select>
            </div>
            
            <div>
                <label for="source-select">–ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö:</label>
                <select id="source-select" class="forecast-select">
                    <option value="all" selected>–í—Å–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏</option>
                    <option value="telegram">Telegram</option>
                    <option value="israil">–ò–∑—Ä–∞–∏–ª—å</option>
                    <option value="ria">–†–ò–ê</option>
                </select>
            </div>
            
            <div>
                <label for="period-select">–ü–µ—Ä–∏–æ–¥ –ø—Ä–æ–≥–Ω–æ–∑–∞:</label>
                <select id="period-select" class="forecast-select">
                    <option value="1">1 –¥–µ–Ω—å</option>
                    <option value="3">3 –¥–Ω—è</option>
                    <option value="7" selected>7 –¥–Ω–µ–π</option>
                    <option value="14">14 –¥–Ω–µ–π</option>
                    <option value="30">30 –¥–Ω–µ–π</option>
                </select>
            </div>
            
            <button id="generate-btn" class="forecast-btn">–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–≥–Ω–æ–∑</button>
        </div>
        
        <div id="loading" class="loading" style="display: none;">–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–æ–≥–Ω–æ–∑–∞...</div>
        
        <div class="forecast-container">
            <div class="forecast-card">
                <h2>–ü—Ä–æ–≥–Ω–æ–∑ –Ω–∞–ø—Ä—è–∂–µ–Ω–Ω–æ—Å—Ç–∏</h2>
                <p>–ü—Ä–æ–≥–Ω–æ–∑ —É—Ä–æ–≤–Ω—è –Ω–∞–ø—Ä—è–∂–µ–Ω–Ω–æ—Å—Ç–∏ –≤ –Ω–æ–≤–æ—Å—Ç–Ω—ã—Ö —Å–≤–æ–¥–∫–∞—Ö –Ω–∞ –æ—Å–Ω–æ–≤–µ –∞–Ω–∞–ª–∏–∑–∞ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤ –∏ —Ç–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ —Ç–µ–∫—Å—Ç–∞.</p>
                <div id="tension-chart" class="forecast-chart">
                    <span>–í—ã–±–µ—Ä–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏ –Ω–∞–∂–º–∏—Ç–µ "–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–≥–Ω–æ–∑"</span>
                </div>
                <div class="forecast-result">
                    <h3>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–æ–≥–Ω–æ–∑–∞:</h3>
                    <table class="forecast-table" id="tension-table">
                        <thead>
                            <tr>
                                <th>–î–∞—Ç–∞</th>
                                <th>–ü—Ä–æ–≥–Ω–æ–∑–∏—Ä—É–µ–º—ã–π —É—Ä–æ–≤–µ–Ω—å</th>
                                <th>–î–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- –î–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                        </tbody>
                    </table>
                </div>
            </div>
            
            <div class="forecast-card">
                <h2>–ü—Ä–æ–≥–Ω–æ–∑ —Ç–µ–º–∞—Ç–∏–∫</h2>
                <p>–ü—Ä–æ–≥–Ω–æ–∑ –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç–∏ –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ç–µ–º–∞—Ç–∏–∫ –≤ –Ω–æ–≤–æ—Å—Ç–Ω—ã—Ö —Å–≤–æ–¥–∫–∞—Ö –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö.</p>
                <div id="topics-chart" class="forecast-chart">
                    <span>–í—ã–±–µ—Ä–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏ –Ω–∞–∂–º–∏—Ç–µ "–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–≥–Ω–æ–∑"</span>
                </div>
                <div class="forecast-result">
                    <h3>–¢–æ–ø —Ç–µ–º–∞—Ç–∏–∫–∏:</h3>
                    <table class="forecast-table" id="topics-table">
                        <thead>
                            <tr>
                                <th>–¢–µ–º–∞—Ç–∏–∫–∞</th>
                                <th>–ü—Ä–æ–≥–Ω–æ–∑–∏—Ä—É–µ–º–∞—è –¥–æ–ª—è</th>
                                <th>–ò–∑–º–µ–Ω–µ–Ω–∏–µ</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- –î–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    
    <div class="footer">
        ¬© 2025 NewsAnalytics Pro. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã. | Leck | Smuzi
    </div>
    
    <script>
        // DOM-—ç–ª–µ–º–µ–Ω—Ç—ã
        const modelSelect = document.getElementById('model-select');
        const sourceSelect = document.getElementById('source-select');
        const periodSelect = document.getElementById('period-select');
        const generateBtn = document.getElementById('generate-btn');
        const refreshBtn = document.getElementById('refresh-btn');
        const loading = document.getElementById('loading');
        const errorContainer = document.getElementById('error-container');
        const tensionChart = document.getElementById('tension-chart');
        const topicsChart = document.getElementById('topics-chart');
        const tensionTable = document.getElementById('tension-table').querySelector('tbody');
        const topicsTable = document.getElementById('topics-table').querySelector('tbody');
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø—Ä–æ–≥–Ω–æ–∑–∞
        generateBtn.addEventListener('click', function() {
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
            showLoading(true);
            clearError();
            
            // –ü–æ–ª—É—á–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
            const model = modelSelect.value;
            const source = sourceSelect.value;
            const period = periodSelect.value;
            
            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å –Ω–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –ø—Ä–æ–≥–Ω–æ–∑–∞
            fetch('/api/generate_forecast', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    model: model,
                    source: source,
                    period: parseInt(period)
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.status === 'success') {
                    // –û–±–Ω–æ–≤–ª—è–µ–º –≥—Ä–∞—Ñ–∏–∫–∏ –∏ —Ç–∞–±–ª–∏—Ü—ã —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏
                    updateTensionChart(data.tension_forecast);
                    updateTopicsChart(data.topics_forecast);
                    updateTensionTable(data.tension_forecast);
                    updateTopicsTable(data.topics_forecast);
                } else {
                    showError(data.message || '–û—à–∏–±–∫–∞ –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø—Ä–æ–≥–Ω–æ–∑–∞');
                }
            })
            .catch(error => {
                showError(`–û—à–∏–±–∫–∞ –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø—Ä–æ–≥–Ω–æ–∑–∞: ${error.message}`);
            })
            .finally(() => {
                showLoading(false);
            });
        });
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
        refreshBtn.addEventListener('click', function() {
            // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö, –µ—Å–ª–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ
            alert('–î–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω—ã!');
        });
        
        // –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–∞ –Ω–∞–ø—Ä—è–∂–µ–Ω–Ω–æ—Å—Ç–∏
        function updateTensionChart(data) {
            // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—É–¥–µ—Ç –∫–æ–¥ –¥–ª—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∏ –≥—Ä–∞—Ñ–∏–∫–∞
            // –ù–∞–ø—Ä–∏–º–µ—Ä, —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ Chart.js –∏–ª–∏ D3.js
            tensionChart.innerHTML = '<img src="' + data.chart_url + '" alt="–ì—Ä–∞—Ñ–∏–∫ –ø—Ä–æ–≥–Ω–æ–∑–∞ –Ω–∞–ø—Ä—è–∂–µ–Ω–Ω–æ—Å—Ç–∏" style="max-width:100%; max-height:300px;">';
        }
        
        // –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–∞ —Ç–µ–º–∞—Ç–∏–∫
        function updateTopicsChart(data) {
            // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—É–¥–µ—Ç –∫–æ–¥ –¥–ª—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∏ –≥—Ä–∞—Ñ–∏–∫–∞
            topicsChart.innerHTML = '<img src="' + data.chart_url + '" alt="–ì—Ä–∞—Ñ–∏–∫ –ø—Ä–æ–≥–Ω–æ–∑–∞ —Ç–µ–º–∞—Ç–∏–∫" style="max-width:100%; max-height:300px;">';
        }
        
        // –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã –Ω–∞–ø—Ä—è–∂–µ–Ω–Ω–æ—Å—Ç–∏
        function updateTensionTable(data) {
            tensionTable.innerHTML = '';
            
            if (!data.values || data.values.length === 0) {
                const row = document.createElement('tr');
                row.innerHTML = '<td colspan="3" style="text-align: center;">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è</td>';
                tensionTable.appendChild(row);
                return;
            }
            
            data.values.forEach(item => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${item.date}</td>
                    <td>${item.value.toFixed(2)}</td>
                    <td>${item.lower_bound.toFixed(2)} - ${item.upper_bound.toFixed(2)}</td>
                `;
                tensionTable.appendChild(row);
            });
        }
        
        // –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã —Ç–µ–º–∞—Ç–∏–∫
        function updateTopicsTable(data) {
            topicsTable.innerHTML = '';
            
            if (!data.topics || data.topics.length === 0) {
                const row = document.createElement('tr');
                row.innerHTML = '<td colspan="3" style="text-align: center;">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è</td>';
                topicsTable.appendChild(row);
                return;
            }
            
            data.topics.forEach(item => {
                const row = document.createElement('tr');
                const changeClass = item.change > 0 ? 'positive-change' : (item.change < 0 ? 'negative-change' : '');
                const changeSign = item.change > 0 ? '+' : '';
                
                row.innerHTML = `
                    <td>${item.name}</td>
                    <td>${(item.value * 100).toFixed(1)}%</td>
                    <td class="${changeClass}">${changeSign}${(item.change * 100).toFixed(1)}%</td>
                `;
                topicsTable.appendChild(row);
            });
        }
        
        // –§—É–Ω–∫—Ü–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è/—Å–∫—Ä—ã—Ç–∏—è –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ –∑–∞–≥—Ä—É–∑–∫–∏
        function showLoading(show) {
            loading.style.display = show ? 'block' : 'none';
        }
        
        // –§—É–Ω–∫—Ü–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ—à–∏–±–∫–∏
        function showError(message) {
            errorContainer.innerHTML = `<div class="error-message">${message}</div>`;
        }
        
        // –§—É–Ω–∫—Ü–∏—è –æ—á–∏—Å—Ç–∫–∏ –æ—à–∏–±–∫–∏
        function clearError() {
            errorContainer.innerHTML = '';
        }
    </script>
</body>
</html>